From 7969b0b6b7d6bc158bf16e2feb215bf3ac9f7d56 Mon Sep 17 00:00:00 2001
From: denis318 <11572080+DenIS318@users.noreply.github.com>
Date: Fri, 6 Jun 2025 17:39:41 +0500
Subject: [PATCH] WIP fixing rebase pt2

---
 code/__DEFINES/subsystems.dm                  |   2 +-
 code/__HELPERS/turfs.dm                       |   8 +-
 code/__HELPERS/~nova_helpers/is_helpers.dm    |   1 +
 code/controllers/subsystem/blackbox.dm        |   5 +-
 .../machinery/dna_infuser/infuser_actions.dm  |   2 +-
 code/modules/admin/antag_panel.dm             |   4 -
 code/modules/client/client_defines.dm         |   3 +
 .../living/carbon/alien/adult/alien_powers.dm |   3 +-
 code/modules/mob/living/silicon/ai/ai.dm      |   9 +-
 .../mob/living/simple_animal/hostile/ooze.dm  |   2 +-
 code/modules/surgery/bodyparts/_bodyparts.dm  |  28 ++++-
 .../vehicles/mecha/mecha_ai_interaction.dm    |  45 ++++---
 .../aesthetics/emitter/code/emitter.dm        |   2 +-
 .../return_prs/ammogun/shotgunbullets.dm      |   2 +-
 .../code/armaments/_armament_primary.dm       |   5 -
 .../code/armaments/armament_miscellaneous.dm  |   2 +-
 tgui/packages/tgui-say/helpers.ts             |   4 +-
 tgui/packages/tgui-say/styles/colors.scss     |  52 ++++++++
 tgui/packages/tgui-say/styles/main.scss       |  39 ++++++
 tgui/packages/tgui-say/styles/styles.scss     | 112 ++++++++++++++++++
 .../tgui/interfaces/ArmamentStation.jsx       |  25 ++--
 .../CharacterPreferences/names.tsx            |   3 +-
 tgui/packages/tgui/styles/layouts/Layout.scss |  54 ---------
 tgui/public/tgui.html                         |  11 +-
 24 files changed, 296 insertions(+), 127 deletions(-)
 create mode 100644 tgui/packages/tgui-say/styles/colors.scss
 create mode 100644 tgui/packages/tgui-say/styles/main.scss
 create mode 100644 tgui/packages/tgui-say/styles/styles.scss

diff --git a/code/__DEFINES/subsystems.dm b/code/__DEFINES/subsystems.dm
index 89b574499bd..28e625a5572 100644
--- a/code/__DEFINES/subsystems.dm
+++ b/code/__DEFINES/subsystems.dm
@@ -174,7 +174,7 @@
 #define FIRE_PRIORITY_SPEECH_CONTROLLER 900
 #define FIRE_PRIORITY_DELAYED_VERBS 950
 #define FIRE_PRIORITY_INPUT 1000 // This must always always be the max highest priority. Player input must never be lost.
-
+#define INIT_ORDER_DEFAULT 0
 
 // SS runlevels
 
diff --git a/code/__HELPERS/turfs.dm b/code/__HELPERS/turfs.dm
index 1aa7fcd65d0..37de67c5f6f 100644
--- a/code/__HELPERS/turfs.dm
+++ b/code/__HELPERS/turfs.dm
@@ -334,8 +334,12 @@ Turf and target are separate in case you want to teleport some distance from a t
 	//fix ratios being off due to screen width/height
 	var/x_ratio = sizex/screen_width
 	var/y_ratio = sizey/screen_height
-	mousepos_x /= x_ratio
-	mousepos_y /= y_ratio
+	// SS1984 EDIT START
+	if (x_ratio != 0)
+		mousepos_x /= x_ratio
+	if (y_ratio != 0)
+		mousepos_y /= y_ratio
+	// SS1984 EDIT END
 
 	//relative to bottom left corner of turf in the middle of the screen
 	var/relative_x = mousepos_x - (screen_width / 2) + (ICON_SIZE_X/2) + viewing_client.pixel_x + viewing_client.pixel_w
diff --git a/code/__HELPERS/~nova_helpers/is_helpers.dm b/code/__HELPERS/~nova_helpers/is_helpers.dm
index 0ad749f8173..14b76963618 100644
--- a/code/__HELPERS/~nova_helpers/is_helpers.dm
+++ b/code/__HELPERS/~nova_helpers/is_helpers.dm
@@ -32,3 +32,4 @@
 #define isfeline(A) (isfelinid(A) || istajaran(A) || HAS_TRAIT(A, TRAIT_FELINE))
 #define iscanine(A) (isvulpkanin(A) || HAS_TRAIT(A, TRAIT_CANINE))
 #define isavian(A) (isteshari(A) || isvox(A) || isvoxprimalis(A) || HAS_TRAIT(A, TRAIT_AVIAN))
+#define isxenmob(A) (istype(A, /mob/living/simple_animal/hostile/blackmesa/xen))
diff --git a/code/controllers/subsystem/blackbox.dm b/code/controllers/subsystem/blackbox.dm
index 04dad09f167..bb76c9a63b4 100644
--- a/code/controllers/subsystem/blackbox.dm
+++ b/code/controllers/subsystem/blackbox.dm
@@ -91,9 +91,8 @@ SUBSYSTEM_DEF(blackbox)
 		if (messages.rc_msgs.len)
 			record_feedback("tally", "radio_usage", messages.rc_msgs.len, "request console")
 
-	for(var/player_key in GLOB.player_details)
-		var/datum/player_details/PD = GLOB.player_details[player_key]
-		record_feedback("tally", "client_byond_version", 1, PD.full_byond_version())
+	for(var/datum/persistent_client/PC as anything in GLOB.persistent_clients)
+		record_feedback("tally", "client_byond_version", 1, PC.full_byond_version())
 
 /datum/controller/subsystem/blackbox/Shutdown()
 	sealed = FALSE
diff --git a/code/game/machinery/dna_infuser/infuser_actions.dm b/code/game/machinery/dna_infuser/infuser_actions.dm
index 494aac36100..9613854627f 100644
--- a/code/game/machinery/dna_infuser/infuser_actions.dm
+++ b/code/game/machinery/dna_infuser/infuser_actions.dm
@@ -50,7 +50,7 @@
 		span_bold("You spit ink."),
 	)
 	var/obj/projectile/ink_spit/ink = new /obj/projectile/ink_spit(clicker.loc)
-	ink.preparePixelProjectile(target, clicker, modifiers)
+	ink.aim_projectile(target, clicker, modifiers)
 	ink.firer = clicker
 	ink.fire()
 	playsound(clicker, 'sound/items/weapons/pierce.ogg', 20, TRUE, -1)
diff --git a/code/modules/admin/antag_panel.dm b/code/modules/admin/antag_panel.dm
index be57f2c342d..8c62fa86122 100644
--- a/code/modules/admin/antag_panel.dm
+++ b/code/modules/admin/antag_panel.dm
@@ -196,14 +196,10 @@ GLOBAL_VAR(antag_prototypes)
 		var/uplink_info = "<i><b>Uplink</b></i>:"
 		var/datum/component/uplink/U = find_syndicate_uplink()
 		if(U)
-			if(!U.uplink_handler.has_objectives)
-				uplink_info += "<a href='byond://?src=[REF(src)];common=takeuplink'>take</a>"
 			if (check_rights(R_FUN, 0))
 				uplink_info += ", <a href='byond://?src=[REF(src)];common=crystals'>[U.uplink_handler.telecrystals]</a> TC"
 				if(U.uplink_handler.has_progression)
 					uplink_info += ", <a href='byond://?src=[REF(src)];common=progression'>[U.uplink_handler.progression_points]</a> PR"
-				if(U.uplink_handler.has_objectives)
-					uplink_info += ", <a href='byond://?src=[REF(src)];common=give_objective'>Force Give Objective</a>"
 			else
 				uplink_info += ", [U.uplink_handler.telecrystals] TC"
 				if(U.uplink_handler.has_progression)
diff --git a/code/modules/client/client_defines.dm b/code/modules/client/client_defines.dm
index 167a9a27e56..4fa51067d77 100644
--- a/code/modules/client/client_defines.dm
+++ b/code/modules/client/client_defines.dm
@@ -270,6 +270,9 @@
 	///Which ambient sound this client is currently being provided.
 	var/current_ambient_sound
 
+	/// The DPI scale of the client. 1 is equivalent to 100% window scaling, 2 will be 200% window scaling
+	var/window_scaling
+
 	/// Does this client's mob need to rebuild its plane masters after login?
 	/// This is currently only used so a client can switch between 515 and 516 without breaking their rendering.
 	var/rebuild_plane_masters = FALSE
diff --git a/code/modules/mob/living/carbon/alien/adult/alien_powers.dm b/code/modules/mob/living/carbon/alien/adult/alien_powers.dm
index 5c31692a835..405473735df 100644
--- a/code/modules/mob/living/carbon/alien/adult/alien_powers.dm
+++ b/code/modules/mob/living/carbon/alien/adult/alien_powers.dm
@@ -294,7 +294,7 @@ Doesn't work on other aliens/AI.*/
 		span_alertalien("You spit neurotoxin."),
 	)
 	var/obj/projectile/neurotoxin/neurotoxin = new /obj/projectile/neurotoxin(clicker.loc)
-	neurotoxin.preparePixelProjectile(target, clicker, modifiers)
+	neurotoxin.aim_projectile(target, clicker, modifiers)
 	neurotoxin.firer = clicker
 	neurotoxin.fire()
 	clicker.newtonian_move(get_angle(target, clicker))
@@ -405,4 +405,3 @@ Doesn't work on other aliens/AI.*/
 /mob/living/carbon/alien/adjustPlasma(amount)
 	. = ..()
 	updatePlasmaDisplay()
-
diff --git a/code/modules/mob/living/silicon/ai/ai.dm b/code/modules/mob/living/silicon/ai/ai.dm
index 83ffb7d9b25..4f5cff6e8af 100644
--- a/code/modules/mob/living/silicon/ai/ai.dm
+++ b/code/modules/mob/living/silicon/ai/ai.dm
@@ -1093,9 +1093,6 @@
 		return ai_voicechanger.say_name
 	return
 
-/mob/living/silicon/ai/verb/ai_change_voice()
-	set name = "Change Voice"
-	set category = "AI Commands"
-	change_voice()
-
-#undef CALL_BOT_COOLDOWN
+#undef HOLOGRAM_CHOICE_CHARACTER
+#undef CHARACTER_TYPE_SELF
+#undef CHARACTER_TYPE_CREWMEMBER
diff --git a/code/modules/mob/living/simple_animal/hostile/ooze.dm b/code/modules/mob/living/simple_animal/hostile/ooze.dm
index a210f84c8ae..13f7383724b 100644
--- a/code/modules/mob/living/simple_animal/hostile/ooze.dm
+++ b/code/modules/mob/living/simple_animal/hostile/ooze.dm
@@ -381,7 +381,7 @@
 
 	var/modifiers = params2list(params)
 	var/obj/projectile/globule/globule = new(clicker.loc)
-	globule.preparePixelProjectile(target, clicker, modifiers)
+	globule.aim_projectile(target, clicker, modifiers)
 	globule.def_zone = clicker.zone_selected
 	globule.fire()
 
diff --git a/code/modules/surgery/bodyparts/_bodyparts.dm b/code/modules/surgery/bodyparts/_bodyparts.dm
index ff277151e28..522732a7aaf 100644
--- a/code/modules/surgery/bodyparts/_bodyparts.dm
+++ b/code/modules/surgery/bodyparts/_bodyparts.dm
@@ -370,9 +370,31 @@
 		if(wound_desc)
 			check_list += "\t[wound_desc]"
 
-	for(var/obj/item/embedded_thing in embedded_objects)
-		var/stuck_word = embedded_thing.is_embed_harmless() ? "stuck" : "embedded"
-		check_list += "\t <a href='byond://?src=[REF(examiner)];embedded_object=[REF(embedded_thing)];embedded_limb=[REF(src)]' class='warning'>There is \a [embedded_thing] [stuck_word] in your [name]!</a>"
+	for(var/obj/item/embedded_thing as anything in embedded_objects)
+		if(embedded_thing.get_embed().stealthy_embed)
+			continue
+		var/harmless = embedded_thing.get_embed().is_harmless()
+		var/stuck_wordage = harmless ? "stuck to" : "embedded in"
+		var/embed_text = "\t<a href='byond://?src=[REF(examiner)];embedded_object=[REF(embedded_thing)];embedded_limb=[REF(src)]'> There is [icon2html(embedded_thing, examiner)] \a [embedded_thing] [stuck_wordage] your [plaintext_zone]!</a>"
+		if (harmless)
+			check_list += span_italics(span_notice(embed_text))
+		else
+			check_list += span_boldwarning(embed_text)
+
+	if(current_gauze)
+		check_list += span_notice("\tThere is some [current_gauze.name] wrapped around it.")
+	else if(can_bleed())
+		switch(get_modified_bleed_rate())
+			if(0.2 to 1)
+				check_list += span_warning("\tIt's lightly bleeding.")
+			if(1 to 2)
+				check_list += span_warning("\tIt's bleeding.")
+			if(3 to 4)
+				check_list += span_warning("\tIt's bleeding heavily!")
+			if(4 to INFINITY)
+				check_list += span_warning("\tIt's bleeding profusely!")
+
+	return jointext(check_list, "<br>")
 
 /obj/item/bodypart/blob_act()
 	receive_damage(max_damage, wound_bonus = CANT_WOUND)
diff --git a/code/modules/vehicles/mecha/mecha_ai_interaction.dm b/code/modules/vehicles/mecha/mecha_ai_interaction.dm
index e991e8d1e95..e518c8eaddc 100644
--- a/code/modules/vehicles/mecha/mecha_ai_interaction.dm
+++ b/code/modules/vehicles/mecha/mecha_ai_interaction.dm
@@ -1,24 +1,13 @@
 /obj/vehicle/sealed/mecha/attack_ai(mob/living/silicon/ai/user)
 	if(!isAI(user))
 		return
-	//Allows the Malf to scan a mech's status and loadout, helping it to decide if it is a worthy chariot.
-	if(user.can_dominate_mechs)
-		examine(user) //Get diagnostic information!
-		for(var/obj/item/mecha_parts/mecha_tracking/B in trackers)
-			to_chat(user, span_danger("Warning: Tracking Beacon detected. Enter at your own risk. Beacon Data:"))
-			to_chat(user, "[B.get_mecha_info()]")
-			break
-		//Nothing like a big, red link to make the player feel powerful!
-		to_chat(user, "<a href='byond://?src=[REF(user)];ai_take_control=[REF(src)]'>[span_userdanger("ASSUME DIRECT CONTROL?")]</a><br>")
-		return
-	examine(user)
-	if(length(return_occupants()) >= max_occupants)
-		to_chat(user, span_warning("This exosuit has a pilot and cannot be controlled."))
-		return
-	var/can_control_mech = FALSE
-	for(var/obj/item/mecha_parts/mecha_tracking/ai_control/A in trackers)
-		can_control_mech = TRUE
-		to_chat(user, "[span_notice("[icon2html(src, user)] Status of [name]:")]\n[A.get_mecha_info()]")
+
+	var/obj/item/mecha_parts/mecha_tracking/data_tracker = null
+	var/obj/item/mecha_parts/mecha_tracking/ai_control/control_tracker = null
+	var/list/output = list()
+
+	for(var/obj/item/mecha_parts/mecha_tracking/A in trackers)
+		data_tracker = A
 		break
 
 	for(var/obj/item/mecha_parts/mecha_tracking/ai_control/B in trackers)
@@ -28,7 +17,25 @@
 	if(!data_tracker)
 		to_chat(user, span_warning("You cannot interface this exosuit without tracking beacons installed."))
 		return
-	to_chat(user, "<a href='byond://?src=[REF(user)];ai_take_control=[REF(src)]'>[span_boldnotice("Take control of exosuit?")]</a><br>")
+
+	if(data_tracker || user.can_dominate_mechs)
+		output += span_notice("[icon2html(src, user)] [name] Exosuit Status Report\n")
+		output += data_tracker.get_mecha_info()
+
+	if(user.can_dominate_mechs)
+		if(data_tracker)
+			output += span_danger("\nWarning: Tracking detected. Enter at your own risk.")
+
+	if(user.can_dominate_mechs)
+		output += "\n<a href='byond://?src=[REF(user)];ai_take_control=[REF(src)]'>[span_warning("\[INITIALIZE CONTROL OVERRIDE\]")]</a>"
+	else if(!control_tracker)
+		output += span_warning("\n\[UNABLE TO CONTROL - NO AI TRACKING BEACONS INSTALLED\]")
+	else if(length(return_occupants()) >= max_occupants)
+		output += span_warning("\n\[UNABLE TO CONTROL - OCCUPIED\]")
+	else
+		output += "\n<a href='byond://?src=[REF(user)];ai_take_control=[REF(src)]'>[span_boldnotice("\[TAKE DIRECT CONTROL\]")]</a>"
+
+	to_chat(user, boxed_message(jointext(output, "\n")))
 
 /obj/vehicle/sealed/mecha/transfer_ai(interaction, mob/user, mob/living/silicon/ai/AI, obj/item/aicard/card)
 	. = ..()
diff --git a/modular_nova/modules/aesthetics/emitter/code/emitter.dm b/modular_nova/modules/aesthetics/emitter/code/emitter.dm
index 3092e9ee779..2bd16cb7c78 100644
--- a/modular_nova/modules/aesthetics/emitter/code/emitter.dm
+++ b/modular_nova/modules/aesthetics/emitter/code/emitter.dm
@@ -5,4 +5,4 @@
 	icon = 'modular_nova/modules/aesthetics/emitter/icons/emitter.dmi'
 
 /obj/machinery/field/generator
-	icon = 'modular_nova/modules/aesthetics/emitter/icons/field_generator.dmi'
+	icon = 'modular_nova/modules/aesthetics/emitter/icons/emitter.dmi'
diff --git a/modular_ss220/modules/return_prs/ammogun/shotgunbullets.dm b/modular_ss220/modules/return_prs/ammogun/shotgunbullets.dm
index 4446ada2371..a0ba9270efb 100644
--- a/modular_ss220/modules/return_prs/ammogun/shotgunbullets.dm
+++ b/modular_ss220/modules/return_prs/ammogun/shotgunbullets.dm
@@ -44,7 +44,7 @@
 	name = "RIP shotgun slug"
 	damage = 50
 	weak_against_armour = TRUE
-	embed_type = /datum/embed_data/shotgun_slug
+	embed_type = /datum/embedding/shotgun_slug
 
 /datum/embedding/shotgun_slug
 	embed_chance = 80
diff --git a/modular_ss220/modules/return_prs/black_mesa/code/armaments/_armament_primary.dm b/modular_ss220/modules/return_prs/black_mesa/code/armaments/_armament_primary.dm
index 9c5344691d1..1779a7e8554 100644
--- a/modular_ss220/modules/return_prs/black_mesa/code/armaments/_armament_primary.dm
+++ b/modular_ss220/modules/return_prs/black_mesa/code/armaments/_armament_primary.dm
@@ -45,11 +45,6 @@
 	max_purchase = 2
 	cost = 5
 
-/datum/armament_entry/hecu/primary/shotgun/autoshotgun_pump
-	item_type = /obj/item/gun/ballistic/shotgun/automatic/as2
-	max_purchase = 1
-	cost = 7
-
 /datum/armament_entry/hecu/primary/special
 	subcategory = ARMAMENT_SUBCATEGORY_SPECIAL
 	mags_to_spawn = 2
diff --git a/modular_ss220/modules/return_prs/black_mesa/code/armaments/armament_miscellaneous.dm b/modular_ss220/modules/return_prs/black_mesa/code/armaments/armament_miscellaneous.dm
index e045b4420a0..f379b53a4d4 100644
--- a/modular_ss220/modules/return_prs/black_mesa/code/armaments/armament_miscellaneous.dm
+++ b/modular_ss220/modules/return_prs/black_mesa/code/armaments/armament_miscellaneous.dm
@@ -43,7 +43,7 @@
 	cost = 1
 
 /datum/armament_entry/hecu/misc/balaclava
-	item_type = /obj/item/clothing/mask/balaclavaadjust
+	item_type = /obj/item/clothing/mask/balaclava/adjustable
 	max_purchase = 6
 	cost = 1
 
diff --git a/tgui/packages/tgui-say/helpers.ts b/tgui/packages/tgui-say/helpers.ts
index edc4b479abd..2cbb0d12b9d 100644
--- a/tgui/packages/tgui-say/helpers.ts
+++ b/tgui/packages/tgui-say/helpers.ts
@@ -1,5 +1,5 @@
-import { Channel } from '../ChannelIterator';
-import { WINDOW_SIZES } from './constants';
+import { Channel } from './ChannelIterator';
+import { RADIO_PREFIXES, WindowSize } from './constants';
 
 /**
  * Once byond signals this via keystroke, it
diff --git a/tgui/packages/tgui-say/styles/colors.scss b/tgui/packages/tgui-say/styles/colors.scss
new file mode 100644
index 00000000000..5bab8b41e5c
--- /dev/null
+++ b/tgui/packages/tgui-say/styles/colors.scss
@@ -0,0 +1,52 @@
+@use 'sass:map';
+
+$background: hsl(0, 0%, 7.5%);
+$button: hsl(0, 0%, 12.2%);
+$lightMode: hsl(0, 0%, 100%);
+$lightBorder: hsl(0, 0%, 73.3%);
+$lightHover: hsl(0, 0%, 91.8%);
+$scrollbar-color-multiplier: 1 !default;
+
+$_channel_map: (
+  'Admin': hsl(300, 100%, 86.7%),
+  'AI': hsl(332.2, 59.6%, 60.2%),
+  'CCom': hsl(197, 62.6%, 39.8%),
+  'Cling': hsl(86.7, 56.6%, 28%),
+  'Cmd': hsl(53, 97.6%, 50%),
+  'Engi': hsl(17, 87.8%, 61.4%),
+  'Hive': hsl(300, 17.7%, 44.3%),
+  'io': hsl(209.6, 100%, 55.9%),
+  'Me': hsl(227, 63.5%, 60.2%),
+  'Med': hsl(202, 83.6%, 64.1%),
+  'OOC': hsl(47.9, 100%, 40%),
+  'Ent': hsl(176.1, 20%, 45.1%),
+  'Radio': hsl(132.8, 74.4%, 45.9%),
+  'Say': hsl(213.6, 37.9%, 74.1%),
+  'Sci': hsl(271.6, 91.7%, 76.5%),
+  'Sec': hsl(0, 71.2%, 53.7%),
+  'Supp': hsl(33.7, 44.9%, 49.8%),
+  'Svc': hsl(88.1, 60.6%, 40.8%),
+  'Synd': hsl(359.1, 31.8%, 42.5%),
+  // NOVA EDIT ADDITION START
+  'LOOC': hsl(20, 100%, 86%),
+  'Dyne': hsl(347, 43%, 47%),
+  'Tark': hsl(42, 43%, 50%),
+  'Csun': hsl(21, 56%, 45%),
+  'Guild': hsl(0, 0%, 70%),
+  'SolFed': hsl(68, 70%, 60%),
+  'Whis': hsl(238, 55%, 67%),
+  'Do': hsl(137, 64%, 60%), // NOVA EDIT ADDITION END
+);
+
+$channel_keys: map.keys($_channel_map) !default;
+
+$channel-map: ();
+
+@each $channel in $channel_keys {
+  $channel-map: map.merge(
+    $channel-map,
+    (
+      $channel: map.get($_channel_map, $channel),
+    )
+  );
+}
diff --git a/tgui/packages/tgui-say/styles/main.scss b/tgui/packages/tgui-say/styles/main.scss
new file mode 100644
index 00000000000..e4b90fc284b
--- /dev/null
+++ b/tgui/packages/tgui-say/styles/main.scss
@@ -0,0 +1,39 @@
+@use 'sass:meta';
+@use 'sass:color';
+@use './colors.scss';
+
+@include meta.load-css('~tgui/styles/reset');
+@include meta.load-css('./styles.scss');
+
+@each $channel, $color in colors.$channel-map {
+  $darkened: color.adjust($color, $lightness: -20%, $space: hsl);
+
+  .button-#{$channel} {
+    border-color: color.adjust($color, $lightness: -10%, $space: hsl);
+    color: $color;
+    user-select: none;
+    &:hover {
+      border-color: color.adjust($color, $lightness: 10%, $space: hsl);
+      color: color.adjust($color, $lightness: 5%, $space: hsl);
+    }
+  }
+
+  .textarea-#{$channel} {
+    color: $color;
+  }
+
+  .window-#{$channel} {
+    background-color: $color;
+  }
+
+  .shine-#{$channel} {
+    background: radial-gradient(
+      circle,
+      color.adjust($color, $lightness: 5%, $space: hsl),
+      color.adjust($color, $lightness: -15%, $space: hsl),
+      color.adjust($color, $lightness: 15%, $space: hsl),
+      color.adjust($color, $lightness: -15%, $space: hsl),
+      color.adjust($color, $lightness: 5%, $space: hsl)
+    );
+  }
+}
diff --git a/tgui/packages/tgui-say/styles/styles.scss b/tgui/packages/tgui-say/styles/styles.scss
new file mode 100644
index 00000000000..e3c35ce9ff3
--- /dev/null
+++ b/tgui/packages/tgui-say/styles/styles.scss
@@ -0,0 +1,112 @@
+@use 'sass:color';
+@use './colors.scss';
+
+.window {
+  background-color: black;
+  position: relative;
+  overflow: hidden;
+}
+
+@keyframes shine {
+  0% {
+    transform: rotate(0deg);
+  }
+  50% {
+    transform: rotate(270deg);
+  }
+  100% {
+    transform: rotate(360deg);
+  }
+}
+
+.shine {
+  animation: shine 15s linear infinite;
+  position: absolute;
+  inset: 0;
+  background-size: 150% 150%;
+}
+
+.window-lightMode {
+  background-color: colors.$lightMode;
+  border: 2px solid colors.$lightBorder;
+}
+
+/** Window sizes */
+.window-30 {
+  height: 30px;
+}
+
+.window-50 {
+  height: 50px;
+}
+
+.window-70 {
+  height: 70px;
+}
+
+.content {
+  background-color: black;
+  display: grid;
+  font: 'tgfont';
+  grid-template-columns: 4rem 1fr;
+  inset: 2px;
+  overflow: hidden;
+  padding: 2px;
+  position: absolute;
+}
+
+.content-lightMode {
+  background-color: white;
+}
+
+.button {
+  background-color: colors.$button;
+  border-radius: 0.3rem;
+  border: none;
+  font-family: inherit;
+  font-size: 11px;
+  font-weight: bold;
+  outline: none;
+  overflow: hidden;
+  padding: 0.1rem;
+  text-align: center;
+  text-overflow: ellipsis;
+  white-space: nowrap;
+  &:hover {
+    background-color: color.adjust(
+      colors.$button,
+      $lightness: 10%,
+      $space: hsl
+    );
+  }
+}
+
+.button-lightMode {
+  background-color: colors.$lightBorder;
+  border: none;
+  color: black;
+  &:hover {
+    background-color: colors.$lightHover;
+  }
+}
+
+.textarea {
+  background: transparent;
+  border: none;
+  font-family: inherit;
+  font-size: 1.1rem;
+  margin: 0.1rem 0 0 0.4rem;
+  outline: none;
+  resize: none;
+  overflow: hidden;
+  scrollbar-width: thin;
+  scrollbar-color: color.scale(
+      colors.$button,
+      $lightness: 20% * colors.$scrollbar-color-multiplier
+    )
+    transparent;
+}
+
+.textarea-large {
+  overflow-y: scroll;
+}
diff --git a/tgui/packages/tgui/interfaces/ArmamentStation.jsx b/tgui/packages/tgui/interfaces/ArmamentStation.jsx
index 42c5a90f049..ed5fa6d5131 100644
--- a/tgui/packages/tgui/interfaces/ArmamentStation.jsx
+++ b/tgui/packages/tgui/interfaces/ArmamentStation.jsx
@@ -1,5 +1,4 @@
-// THIS IS A SKYRAT UI FILE
-import { useBackend, useLocalState } from '../backend';
+// THIS IS A NOVA SECTOR UI FILE
 import {
   Box,
   Button,
@@ -21,7 +20,7 @@ export const ArmamentStation = (props) => {
   return (
     <Window theme="armament" title="Armament Station" width={1000} height={600}>
       <Window.Content>
-        <Section grow height="100%" title="Armaments Station">
+        <Section height="100%" title="Armaments Station">
           {card_inserted ? (
             <Stack>
               <Stack.Item grow fill>
@@ -97,8 +96,8 @@ export const ArmamentStation = (props) => {
                                 <img
                                   src={`data:image/jpeg;base64,${item.icon}`}
                                   style={{
-                                    verticalAlign: 'middle',
-                                    textAlign: 'center',
+                                    'vertical-align': 'middle',
+                                    'horizontal-align': 'middle',
                                   }}
                                 />
                                 &nbsp;{item.name}
@@ -121,15 +120,15 @@ export const ArmamentStation = (props) => {
                         item.ref === weapon && (
                           <Stack vertical key={item.ref}>
                             <Stack.Item>
-                              <Image
-                                src={`data:image/jpeg;base64,${item.icon}`}
-                                height={'100%'}
-                                width={'100%'}
-                                style={{
-                                  verticalAlign: 'middle',
-                                  horizontalAlign: 'middle',
+                              <Image>
+                                src=
+                                {`data:image/jpeg;base64,${item.icon}`}
+                                height={'100%'} width={'100%'} style=
+                                {{
+                                  'vertical-align': 'middle',
+                                  'horizontal-align': 'middle',
                                 }}
-                              />
+                              </Image>
                             </Stack.Item>
                             <Stack.Item>{item.description}</Stack.Item>
                             <Stack.Item
diff --git a/tgui/packages/tgui/interfaces/PreferencesMenu/CharacterPreferences/names.tsx b/tgui/packages/tgui/interfaces/PreferencesMenu/CharacterPreferences/names.tsx
index 140b55baa61..a77baadbd9c 100644
--- a/tgui/packages/tgui/interfaces/PreferencesMenu/CharacterPreferences/names.tsx
+++ b/tgui/packages/tgui/interfaces/PreferencesMenu/CharacterPreferences/names.tsx
@@ -153,8 +153,7 @@ export function NameInput(props: NameInputProps) {
           {editing ? (
             <Input
               autoSelect
-              expensive
-              onBlur={updateName} // SS1984 EDIT
+              onBlur={updateName}
               onEscape={() => {
                 setLastNameBeforeEdit(null);
               }}
diff --git a/tgui/packages/tgui/styles/layouts/Layout.scss b/tgui/packages/tgui/styles/layouts/Layout.scss
index fd4e40ba56e..22d5c83572f 100644
--- a/tgui/packages/tgui/styles/layouts/Layout.scss
+++ b/tgui/packages/tgui/styles/layouts/Layout.scss
@@ -3,60 +3,6 @@
  * SPDX-License-Identifier: MIT
  */
 
-@use 'sass:color';
-@use '../base';
-@use '../functions.scss' as *;
-
-$luminance: luminance(base.$color-bg);
-$scrollbar-color-multiplier: 1 !default;
-$scrollbar-base: color.scale(
-  base.$color-bg,
-  $lightness: -33% * $scrollbar-color-multiplier
-);
-$scrollbar-face: color.scale(
-  base.$color-bg,
-  $lightness: if($luminance > 0.05, 30%, 10%) * $scrollbar-color-multiplier
-);
-
-// Fancy scrollbar
-html,
-body {
-  scrollbar-color: $scrollbar-face $scrollbar-base;
-}
-
-// Remove with 516, IE legacy code
-.Layout,
-.Layout * {
-  scrollbar-base-color: color.scale(
-    base.$color-bg,
-    $lightness: -25% * $scrollbar-color-multiplier
-  );
-  scrollbar-face-color: color.scale(
-    base.$color-bg,
-    $lightness: 10% * $scrollbar-color-multiplier
-  );
-  scrollbar-3dlight-color: color.scale(
-    base.$color-bg,
-    $lightness: 0% * $scrollbar-color-multiplier
-  );
-  scrollbar-highlight-color: color.scale(
-    base.$color-bg,
-    $lightness: 0% * $scrollbar-color-multiplier
-  );
-  scrollbar-track-color: color.scale(
-    base.$color-bg,
-    $lightness: -25% * $scrollbar-color-multiplier
-  );
-  scrollbar-arrow-color: color.scale(
-    base.$color-bg,
-    $lightness: 50% * $scrollbar-color-multiplier
-  );
-  scrollbar-shadow-color: color.scale(
-    base.$color-bg,
-    $lightness: 10% * $scrollbar-color-multiplier
-  );
-}
-
 .Layout__content {
   overflow-x: hidden;
   overflow-y: hidden;
diff --git a/tgui/public/tgui.html b/tgui/public/tgui.html
index c93c0723498..923d858279f 100644
--- a/tgui/public/tgui.html
+++ b/tgui/public/tgui.html
@@ -53,10 +53,9 @@ o8o        `8    "888"  `Y8bood8P'  8""88888P'
       </div>
     </noscript>
 
-<script>
-// Signal tgui that we're ready to receive updates
-Byond.sendMessage('ready');
-</script>
-
-</body>
+    <script>
+      // Signal tgui that we're ready to receive updates
+      Byond.sendMessage('ready');
+    </script>
+  </body>
 </html>
-- 
2.43.0.windows.1

